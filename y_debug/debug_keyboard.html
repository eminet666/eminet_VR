<html>

<head>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script>
        AFRAME.registerComponent('keyboard-controller', {
            schema: {
                key: { type: 'array' },
                target: { type: 'array' },
                event: { type: 'array' },
            },
            init: function () {
                let key = this.data.key;
                let event = this.data.event;
                let target = this.data.target;
                document.addEventListener('keypress', evt => {
                    for( var i = 0; i < key.length; i++){
                        if (evt.keyCode === key[i].codePointAt(0)) {
                            let cible = document.querySelector(target[i]);
                            cible.emit(event[i]);
                            console.log("event "+event[i]+ " sent to "+target[i]);
                        }
                    }
                });
            }
        });
        AFRAME.registerComponent('tourne', {
            schema: {
                angle: { type: 'number', default: 45 },
            },
            init: function () {
                let angle = this.data.angle;
                el = this.el;

                document.addEventListener('tourne', evt => {
                    let rot = el.getAttribute('rotation');
                    rot.y += angle;
                    el.setAttribute('rotation', '0 '+rot.y+' 0');
                });
            }
        });        
    </script>
</head>

<body>
    <a-scene background="color: skyblue" 
        keyboard-controller="key: r, t; event: tourne, hello2; target: #boite, #boule">

        <a-box id="boite" position="-1 0.5 -3" rotation="0 45 0" 
            color="#4CC3D9" tourne="angle: 30">
        </a-box>
        <a-sphere id="boule" position="0 1.25 -5" 
            radius="1.25" color="#EF2D5E"></a-sphere>

        <a-cylinder position="1 0.75 -3" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>
        <a-plane position="0 0 -4" rotation="-90 0 0" width="4" height="4" color="#7BC8A4"></a-plane>
        <a-sky color="#ECECEC"></a-sky>

        <a-entity camera position="0 1.6 0" look-controls wasd-controls></a-entity>

    </a-scene>
</body>

</html>